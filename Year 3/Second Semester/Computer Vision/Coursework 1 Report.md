best threshold for part 3 was around 60 with no smoothing (though the results still sucks)
with weighted smoothing, it was more like 35-ish (had much more defined edges but still noisy)
